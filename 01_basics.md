# 1. Основы ботоводства

Для того, чтобы приступить к изучению курса, нужно проверить свой уровень. 

## Задание

Напишите программу на Python, которая запрашивает у пользователя его имя и определяет его "цвет" на основе следующих критериев:

**1. Сумма ASCII-кодов символов:**

- Если сумма ASCII-кодов всех символов в имени четная, то цвет — "синий".
- Если сумма кратна трём, то цвет — "зеленый".
- Если сумма кратна и двум, и трём одновременно, то цвет — "серый".
- Если не подходит ни под одно условие, то цвет — "красный".

**2. Длина имени:**

-    Если длина имени больше 10 символов, то к цвету добавляется приставка "светло-".
-    Если длина имени меньше 5 символов, то к цвету добавляется приставка "темно-".

**3. Примечание:**

```
print(ord('w'))  # Вывод: 119
```

## Регистрация бота в Telegram

В этом уроке мы рассмотрим, как создать бота в Telegram и получить его уникальный токен, который необходим для взаимодействия с Telegram Bot API. Это первый шаг в разработке вашего собственного телеграм-бота.

### Шаг 1: Установка Telegram и поиск BotFather

- Установите Telegram: Если у вас еще нет Telegram, скачайте и установите приложение с официального сайта telegram.org или из магазина приложений вашего устройства.
- Откройте Telegram и войдите в систему: Используйте ваш номер телефона или логин, чтобы войти в приложение.
- Найдите BotFather: В строке поиска введите @BotFather и выберите официального бота от Telegram.

### Шаг 2: Создание нового бота

**Начните диалог с BotFather:**

- Нажмите кнопку "Start" или отправьте команду `/start`, чтобы начать взаимодействие с BotFather.

**Создайте нового бота:**

- Отправьте команду `/newbot` в чате с BotFather.
- BotFather попросит вас ввести имя для вашего бота. Это имя будет отображаться в списке контактов и в верхней части чата. Введите желаемое имя, например, "MyFirstBot".

**Укажите имя пользователя для бота:**

- После ввода имени BotFather попросит вас указать имя пользователя для вашего бота. Имя пользователя должно быть уникальным и заканчиваться на bot (например, MyFirstBot_bot).
- Введите имя пользователя и подтвердите его.

**Получите токен**

- После успешного создания бота BotFather отправит вам сообщение с токеном вашего бота. Этот токен выглядит как строка из букв и цифр, например: `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`

- **Важно**: Сохраните этот токен в безопасном месте, так как он необходим для управления вашим ботом и взаимодействия с Telegram API.

### Шаг 3: Настройка бота (опционально)

**Настройка описания и информации:**

- Вы можете использовать команды, предоставляемые BotFather, для настройки описания, информации о боте, аватарки и других параметров.
- Например, используйте команду `/setdescription`, чтобы добавить описание вашему боту.

**Настройка команд:**

- Используйте команду `/setcommands`, чтобы определить команды, которые будет поддерживать ваш бот.
- Это позволит пользователям видеть список доступных команд при нажатии на кнопку "Commands" в чате с ботом.

### Шаг 4: Проверка бота

- **Найдите вашего бота в Telegram**: Используйте имя пользователя, которое вы указали, чтобы найти вашего бота в Telegram.
- **Начните диалог с ботом**: Нажмите кнопку "Start" или отправьте команду `/start`, чтобы начать взаимодействие с ботом.
- **Тестирование**: Попробуйте отправить несколько команд и сообщений, чтобы убедиться, что бот реагирует. Пока что он не будет выполнять никаких действий, так как мы еще не написали для него код.

### Советы:

- **Безопасность**: Никогда не передавайте токен вашего бота другим людям, так как это может привести к несанкционированному доступу и управлению вашим ботом.
- **Управление ботом**: Вы можете использовать BotFather для изменения настроек, добавления новых команд и управления другими аспектами вашего бота в любое время.
- **Документация**: Ознакомьтесь с официальной документацией Telegram Bot API для получения более подробной информации о возможностях и функциях ботов.

### Шаг 5: Задать аватар, описание и команды

Чтобы придать "товарный вид" вашему телеграм-боту, нужно использовать BotFather — официального бота Telegram для управления ботами. Вот как это сделать:

#### 5.1. Установка Аватарки (Картинки)

- Откройте диалог с BotFather: Найдите @BotFather в Telegram и начните с ним диалог, если еще не сделали этого.
- Выберите вашего бота: Используйте команду `/mybots`, чтобы увидеть список всех ваших ботов.
- Выберите бот для редактирования: Из списка выберите бот, которому вы хотите установить аватар.
- Загрузите аватар, используя команду `/setuserpic`
- BotFather попросит вас загрузить изображение. Отправьте изображение, которое вы хотите использовать в качестве аватара для вашего бота.
- Примечание: Изображение должно быть в формате JPG, PNG или GIF и не должно превышать 256 КБ.
- Подтверждение: После загрузки BotFather подтвердит изменение аватара.

#### 5.2. Установка Описания

- Откройте диалог с BotFather: Если вы еще не сделали этого, найдите @BotFather и начните с ним диалог.
- Выберите вашего бота: Используйте команду `/mybots`, чтобы увидеть список всех ваших ботов.
- Выберите бот для редактирования: Из списка выберите бот, которому вы хотите установить описание.
- Установите описание используя команду `/setdescription`
- BotFather попросит вас ввести новое описание для вашего бота.
- Введите текст, который будет отображаться как описание вашего бота.
- Пример: "Этот бот поможет вам управлять вашими задачами и напоминаниями."
- Подтверждение: BotFather подтвердит изменение описания.

#### 5.3. Установка Команд

- Откройте диалог с BotFather: Найдите @BotFather и начните с ним диалог.
- Выберите вашего бота: Используйте команду `/mybots`, чтобы увидеть список всех ваших ботов.
- Выберите бот для редактирования: Из списка выберите бот, для которого вы хотите установить команды.
- Установите команды используя команду `/setcommands`.
- BotFather попросит вас ввести список команд в определенном формате. Каждая команда должна быть описана в отдельной строке в формате `команда1 - описание команды1`.
- Подтверждение: BotFather подтвердит изменение списка команд.

**Пример:**

```
start - Начать работу с ботом
help - Получить справку по командам
settings - Настроить параметры
taskadd - Добавить новую задачу
tasklist - Показать список задач
```

#### Что ещё:

- **Обновление команд**: Вы можете в любой момент обновить список команд, повторно используя команду `/setcommands` и предоставив новый список.
- **Описание и команды**: Хорошо продуманное описание и список команд помогут пользователям лучше понять, что может делать ваш бот и как его использовать.
- **Тестирование**: После настройки аватара, описания и команд протестируйте их, чтобы убедиться, что все работает как ожидается.


## Основы сетевых запросов (GET и POST)

Веб-приложения и API часто взаимодействуют с серверами с помощью HTTP-запросов. Двумя наиболее распространенными методами HTTP-запросов являются GET и POST.
GET-запросы

GET-запросы используются для получения данных с сервера. Они не должны изменять состояние сервера и обычно применяются для извлечения информации.

**Особенности**

- Данные передаются в URL в виде параметров запроса.
- Можно добавлять параметры в конец URL после знака вопроса (?), разделяя их амперсандом (&).

### getMe

#### Бот получает информацию о самом себе

`https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/getMe`

Что здесь происходит:

1. В строке явно виден токен, который мы получили при регистрации бота

`123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`

2. Строка заканчивается ключом getMe

Перейдите по этой ссылке и вам ответит сервер Телеграм. В ответе будет видна информация о вашем боте.

`{`
  `"ok": true,`
  `"result": {`
    `"id": 123456,`
    `"is_bot": true,`
    `"first_name": "Test",`
    `"username": "Test",`
    `"can_join_groups": true,`
    `"can_read_all_group_messages": false,`
    `"supports_inline_queries": false,`
    `"can_connect_to_business": false,`
    `"has_main_web_app": false`
  `}`
`}`

**Используем Python**

```
import requests

token = "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
key = "getMe"
url = f"https://api.telegram.org/bot{token}/{key}"
response = requests.get(url, timeout=30)
print(response.status_code)  # Вывод: 200
print(response.json())
```

**Вывод**

```{'ok': True, 'result': {'id': 123456, 'is_bot': True, 'first_name': 'Test', 'username': 'Test', 'can_join_groups': True, 'can_read_all_group_messages': False, 'supports_inline_queries': False, 'can_connect_to_business': False, 'has_main_web_app': False}}```

Что здесь происходит:

1. Сначала создаётся url из токена и ключа.
2. Затем делается запрос методом GET. Это аналог того, что мы делали только что в браузере.


## getUpdates

### Бот получает информацию о действиях пользователей

`https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/getUpdates`

**Используем Python**

`import requests`

`token = "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"`
`key = "getUpdates"`
`url = f"https://api.telegram.org/bot{token}/{key}"`
`response = requests.get(url, timeout=30)`
`print(response.json())`

Вывод

`{'ok': True, 'result': []}`

Видно, что к боту в последнее время никто не обращался. Список result пуст. Напишите боту что-нибудь и проверьте, что получится.

`{`
    `"ok": true,`
    `"result": [`
        `{`
            `"update_id": 111,`
            `"message": {`
                `"message_id": 1,`
                `"from": {`
                    `"id": 1234567890,`
                    `"is_bot": false,`
                    `"first_name": "User",`
                    `"username": "username",`
                    `"language_code": "ru",`
                    `"is_premium": true`
                `},`
                `"chat": {`
                    `"id": 1234567890,`
                    `"first_name": "User",`
                    `"username": "username",`
                    `"type": "private"`
                `},`
                `"date": 1738335868,`
                `"text": "/start",`
                `"entities": [`
                    `{`
                        `"offset": 0,`
                        `"length": 6,`
                        `"type": "bot_command"`
                    `}`
                `]`
            `}`
        `}`
    `]`
`}`

Теперь в списке result появилась информация о том, кто и что написал боту.

В блоке message:

- message_id - порядковый номер действия с ботом

В блоке from:

- id - Телеграм ID пользователя. Основное, что нужно, чтобы отправить сообщение пользователю.
- first_name, last_name - Имя и фамилия пользователя
- username - Username пользователя
- date - Unix-время, когда было отправлено сообщение
- text - Текст сообщения, которое послал пользователь боту

Теперь мы знаем кому можно написать.

### sendMessage

#### Отправить сообщение пользователю

`https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/sendMessage?chat_id=1234567890&text=Привет,+как+дела`

Что здесь происходит

1. К уже известной строке URL добавляются GET-параметры после ? следуют парами и разделяются &. Если в текстовом сообщении есть пробелы, то их нужно заменить на спецсимволы или +. Если встретятся вопросы или ампесанды, то их тоже нужно заменить.

`?chat_id=1234567890&text=Привет,+как+дела`

Так можно отправить сообщение в качестве эксперимента, но организовывать работу бота таким образом нельзя.

Используем Python

```
import requests

token = "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
key = "sendMessage"
text = "Привет, как дела"
text = text.replace(" ", "+")
url = f"https://api.telegram.org/bot{token}/{key}"
params = {"chat_id": 1234567890, "text": text}
response = requests.get(url, params=params, timeout=30)
print(response.json())
```
 
### POST-запросы

POST-запросы используются для отправки данных на сервер, чтобы создать или обновить ресурс. Они могут изменять состояние сервера.

Особенности

- Данные передаются в теле запроса, а не в URL.
- Более безопасно передавать конфиденциальную информацию, так как она не отображается в URL.
- Пример: отправка формы с данными.

 Пример
 
```
import requests

token = "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
key = "sendMessage"
text = "Привет, как дела"
text = text.replace(" ", "+")
url = f"https://api.telegram.org/bot{token}/{key}"
params = {"chat_id": 1234567890, "text": text}
response = requests.post(url, params=params, timeout=30)
print(response.json())
```

Ключевые различия:

- Передача данных: GET передает данные в URL, POST — в теле запроса.
- Безопасность: POST более безопасен для передачи чувствительных данных, так как они не отображаются в URL.
- Изменение состояния: GET не должен изменять состояние сервера, в то время как POST может.

Практическое применение:

- Используйте GET для запросов, которые не изменяют данные на сервере, например, для получения информации.
- Используйте POST для операций, которые изменяют данные, например, для отправки форм или создания новых записей.

## Задание

1. Создайте и зарегистрируйте нового телеграм-бота через @BotFather. Настройте его аватар и описание, чтобы придать ему индивидуальность.

2. Получите имя пользователя вашего бота и сохраните токен в безопасном месте.

3. Отправьте имя вашего бота в качестве ответа.